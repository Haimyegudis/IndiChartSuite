<Window x:Class="IndiChart.UI.ReferenceLineManager"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:IndiChart.UI"
        mc:Ignorable="d"
        Title="Reference Lines Manager" Height="514" Width="700" 
        WindowStartupLocation="CenterOwner" ResizeMode="NoResize" Topmost="True">

    <Window.Resources>
        <local:NullToBoolConverter x:Key="NullToBoolConverter"/>
    </Window.Resources>

    <Grid Margin="10">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="220"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <GroupBox Header="Lines List" Grid.Column="0">
            <DockPanel>
                <StackPanel DockPanel.Dock="Bottom" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,10,0,0">
                    <Button Name="BtnAdd" Content="➕ Add New" Width="80" Margin="5" Padding="5" Click="BtnAdd_Click"/>
                    <Button Name="BtnRemove" Content="➖ Remove" Width="80" Margin="5" Padding="5" Click="BtnRemove_Click"/>
                </StackPanel>
                <ListBox Name="LinesListBox" DisplayMemberPath="Name" Margin="0,0,0,5" SelectionMode="Single" SelectionChanged="LinesListBox_SelectionChanged"/>
            </DockPanel>
        </GroupBox>

        <GroupBox Header="Edit Selected Line" Grid.Column="1" Margin="10,0,0,0" 
                  IsEnabled="{Binding ElementName=LinesListBox, Path=SelectedItem, Converter={StaticResource NullToBoolConverter}}">
            <StackPanel Margin="10" DataContext="{Binding ElementName=LinesListBox, Path=SelectedItem}">

                <TextBlock Text="Name:" FontWeight="Bold"/>
                <TextBox Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}" Margin="0,0,0,10" Padding="3"/>

                <TextBlock Text="Type:" FontWeight="Bold"/>
                <ComboBox Name="CmbType" SelectedItem="{Binding Type, Mode=TwoWay}" Margin="0,0,0,10" Padding="3"/>

                <TextBlock Text="Value:" FontWeight="Bold"/>
                <TextBlock Text="(For Vertical: Line Index / For Horizontal: Y-Value)" FontSize="10" Foreground="Gray"/>
                <TextBlock Text="(Decimal numbers supported, e.g. 23.5)" FontSize="9" Foreground="#2563EB" Margin="0,0,0,2"/>
                <TextBox Name="TxtValue" Text="{Binding Value, UpdateSourceTrigger=PropertyChanged, StringFormat=F2}" Margin="0,0,0,10" Padding="3"/>

                <TextBlock Text="Axis (For Horizontal Only):" FontWeight="Bold"/>
                <ComboBox Name="CmbAxis" SelectedItem="{Binding YAxis, Mode=TwoWay}" Margin="0,0,0,10" Padding="3"/>

                <TextBlock Text="Color:" FontWeight="Bold"/>
                <ComboBox Name="CmbColor" SelectedIndex="0" Margin="0,0,0,10" Padding="3,5" SelectionChanged="CmbColor_SelectionChanged">
                    <ComboBoxItem Tag="#FF0000">
                        <StackPanel Orientation="Horizontal">
                            <Rectangle Width="30" Height="16" Fill="#FF0000" Stroke="Gray" StrokeThickness="1" Margin="0,0,8,0"/>
                            <TextBlock Text="Red" VerticalAlignment="Center"/>
                        </StackPanel>
                    </ComboBoxItem>
                    <ComboBoxItem Tag="#0000FF">
                        <StackPanel Orientation="Horizontal">
                            <Rectangle Width="30" Height="16" Fill="#0000FF" Stroke="Gray" StrokeThickness="1" Margin="0,0,8,0"/>
                            <TextBlock Text="Blue" VerticalAlignment="Center"/>
                        </StackPanel>
                    </ComboBoxItem>
                    <ComboBoxItem Tag="#00FF00">
                        <StackPanel Orientation="Horizontal">
                            <Rectangle Width="30" Height="16" Fill="#00FF00" Stroke="Gray" StrokeThickness="1" Margin="0,0,8,0"/>
                            <TextBlock Text="Green" VerticalAlignment="Center"/>
                        </StackPanel>
                    </ComboBoxItem>
                    <ComboBoxItem Tag="#FF8800">
                        <StackPanel Orientation="Horizontal">
                            <Rectangle Width="30" Height="16" Fill="#FF8800" Stroke="Gray" StrokeThickness="1" Margin="0,0,8,0"/>
                            <TextBlock Text="Orange" VerticalAlignment="Center"/>
                        </StackPanel>
                    </ComboBoxItem>
                    <ComboBoxItem Tag="#800080">
                        <StackPanel Orientation="Horizontal">
                            <Rectangle Width="30" Height="16" Fill="#800080" Stroke="Gray" StrokeThickness="1" Margin="0,0,8,0"/>
                            <TextBlock Text="Purple" VerticalAlignment="Center"/>
                        </StackPanel>
                    </ComboBoxItem>
                    <ComboBoxItem Tag="#FFFF00">
                        <StackPanel Orientation="Horizontal">
                            <Rectangle Width="30" Height="16" Fill="#FFFF00" Stroke="Gray" StrokeThickness="1" Margin="0,0,8,0"/>
                            <TextBlock Text="Yellow" VerticalAlignment="Center"/>
                        </StackPanel>
                    </ComboBoxItem>
                    <ComboBoxItem Tag="#00FFFF">
                        <StackPanel Orientation="Horizontal">
                            <Rectangle Width="30" Height="16" Fill="#00FFFF" Stroke="Gray" StrokeThickness="1" Margin="0,0,8,0"/>
                            <TextBlock Text="Cyan" VerticalAlignment="Center"/>
                        </StackPanel>
                    </ComboBoxItem>
                    <ComboBoxItem Tag="#FF00FF">
                        <StackPanel Orientation="Horizontal">
                            <Rectangle Width="30" Height="16" Fill="#FF00FF" Stroke="Gray" StrokeThickness="1" Margin="0,0,8,0"/>
                            <TextBlock Text="Magenta" VerticalAlignment="Center"/>
                        </StackPanel>
                    </ComboBoxItem>
                    <ComboBoxItem Tag="#000000">
                        <StackPanel Orientation="Horizontal">
                            <Rectangle Width="30" Height="16" Fill="#000000" Stroke="Gray" StrokeThickness="1" Margin="0,0,8,0"/>
                            <TextBlock Text="Black" VerticalAlignment="Center"/>
                        </StackPanel>
                    </ComboBoxItem>
                    <ComboBoxItem Tag="#808080">
                        <StackPanel Orientation="Horizontal">
                            <Rectangle Width="30" Height="16" Fill="#808080" Stroke="Gray" StrokeThickness="1" Margin="0,0,8,0"/>
                            <TextBlock Text="Gray" VerticalAlignment="Center"/>
                        </StackPanel>
                    </ComboBoxItem>
                    <ComboBoxItem Tag="#FFC0CB">
                        <StackPanel Orientation="Horizontal">
                            <Rectangle Width="30" Height="16" Fill="#FFC0CB" Stroke="Gray" StrokeThickness="1" Margin="0,0,8,0"/>
                            <TextBlock Text="Pink" VerticalAlignment="Center"/>
                        </StackPanel>
                    </ComboBoxItem>
                    <ComboBoxItem Tag="#8B4513">
                        <StackPanel Orientation="Horizontal">
                            <Rectangle Width="30" Height="16" Fill="#8B4513" Stroke="Gray" StrokeThickness="1" Margin="0,0,8,0"/>
                            <TextBlock Text="Brown" VerticalAlignment="Center"/>
                        </StackPanel>
                    </ComboBoxItem>
                </ComboBox>

                <TextBlock Text="Thickness:" FontWeight="Bold"/>
                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                    <Slider Minimum="1" Maximum="10" Width="200" Value="{Binding Thickness}" AutoToolTipPlacement="TopLeft"/>
                    <TextBlock Text="{Binding Thickness, StringFormat=N1}" Margin="10,0,0,0" VerticalAlignment="Center"/>
                </StackPanel>

                <CheckBox Content="Dashed Line" IsChecked="{Binding IsDashed}" Margin="0,10" FontWeight="Bold"/>

                <Button Name="BtnApply" Content="✓ Apply Changes" Width="150" Margin="0,20,0,0" Padding="8"
                        Background="#10B981" Foreground="White" FontWeight="Bold" Click="BtnApply_Click"/>

            </StackPanel>
        </GroupBox>
    </Grid>
</Window>